# Типы для работы с датами и временем


## Даты


`PostgreSQ`L` поддерживает все типы данных, предусмотренные стандартом SQL для даты и времени. 
Даты обрабатываются в соответствии с григорианским календарем, причем это делается даже в тех случаях, когда дата относится к тому моменту време
ни, когда этот календарь в данной стране еще не был принят. 

Для этих типов данных предусмотрены определенные форматы для ввода значений и для вывода. 

Причем эти форматы могут не совпадать. 

Важно помнить, что при вводе значений их нужно заключать в одинарные кавычки, как и текстовые строки.
Начнем рассмотрение с типа date. 

Рекомендуемый стандартом `ISO 8601` формат ввода дат таков: `«yyyy-mm-dd»`, где символы `«y», «m» и «d»` обозначают цифру года, месяца и дня соответственно. 



`PostgreSQL` позволяет использовать и другие форматы для ввода, например: `«Sep 12, 2016»`, что означает 12 сентября 2016 года. 

При выводе значений PostgreSQL использует формат по умолчанию, если не предписан другой формат. 
По умолчанию используется формат, рекомендуемый стандартом ISO 8601: `«yyyy-mm-dd»`.


* `date`: представляет дату от 4713 г. до н.э. до 5874897 г н.э. Занимает 4 байта.


```sql
SELECT '2024-12-31'::date;
```

А в следующем примере используется другой формат ввода, но формат вывода остается тот же самый, поскольку мы его не изменяли:

```sql
SELECT 'Dec 31, 2024'::date;
```

Чтобы «сказать» СУБД, что введенное значение является датой, а не простой символьной строкой, мы использовали операцию приведения типа.

В PostgreSQL она оформляется с использованием двойного символа «двоеточие» и имени того типа, к которому мы приводим данное значение. 

Важно учесть, что при выполнении при ведения типа производится проверка значения на соответствие формату целевого типа и множеству его допустимых значений.

В PostgreSQL предусмотрен целый ряд функций для работы с датами и временем. 

Например, для получения значения текущей даты служит функция current_date.
Ее особенностью является то, что при ее вызове круглые скобки не используются

Если нам требуется вывести дату в другом формате, то для разового преобразования формата можно использовать функцию `to_char`
```sql
SELECT current_date; --2024-10-18
SELECT to_char( current_date, 'dd-mm-yyyy' ); -- 18-10-2024
```

Обратите внимание, что для демонстрации возможностей `СУБД` по работе с датами нам даже не потребовалось создавать таблицу, а оказалось достаточно лишь команды `SELECT`.


## Время

Для хранения времени суток служат два типа данных: time и time with time zone. 
Первый из них хранит только время суток, а второй — дополнительно — еще и часовой пояс. 
Однако документация на PostgreSQL не рекомендует использовать тип time with time zone, поскольку смещение (offset), соответствующее конкретному
часовому поясу, может зависеть от даты перехода на летнее время и обратно, но в этом типе дата отсутствует. 




* `time`: хранит время с точностью до 1 микросекунды без указания часового пояса. 

* `timestamp`: хранит дату и время. Занимает 8 байт. Для дат самое нижнее значение - 4713 г до н.э., самое верхнее значение - 294276 г н.э.

* `timestamp` with time zone: то же самое, что и timestamp, только добавляет данные о часовом поясе.

При вводе значений времени допустимы различные форматы, например:

Время можно вводить не только в 24-часовом формате, но и в 12-часовом, при этом нужно использовать дополнительные суффиксы am и pm. 

```sql

SELECT '21:15'::time; --21:15:00

--SELECT '25:15'::time; --значение поля типа date/time вне диапазона: "25:15"

SELECT '21:15:26'::time; --21:15:26

SELECT '10:15:16 am'::time; -- 10:15:16

SELECT '10:15:16 pm'::time; -- 22:15:16
```

Для получения значения текущего времени служит функция `current_time`. 
При ее вызове круглые скобки не используются.

Текущее время выводится с высокой точностью и дополняется числовым значением, соответствующим локальному часовому поясу, который установлен в конфигурационном файле сервера PostgreSQL. 

В приведенном примере значение часового пояса равно +03, но если ваш компьютер находится в другом часовом поясе, то это значение будет другим, например, для регионов Сибири оно может быть +08.


```sql
SELECT current_time;
SELECT current_date AS today, current_time AS right_now;

SELECT timestamp with time zone '2024-12-31 22:25:35'; -- 2024-12-31 22:25:35+03
```
В результате объединения типов даты и времени получается интегральный тип — временная отметка. 

Этот тип существует в двух вариантах: с учетом часового пояса — `timestamp with time zone`, либо без учета часового пояса — `timestamp`.
Для первого варианта существует сокращенное наименование — `timestamptz`, которое является расширением `PostgreSQL`. 
При вводе и выводе значений этого типа данных используются соответствующие форматы ввода и вывода даты и времени. 

```sql
SELECT timestamp '2024-12-31 22:25:35'; -- 2024-12-31 22:25:35
```

Обратите внимание, что хотя мы не указали явно значение часового пояса при вводе данных, при выводе это значение +03 было добавлено.

В рассмотренных примерах мы использовали синтаксис тип 'строка' для указания конкретного типа простой литеральной константы. Имя типа мы указывали не после преобразуемого литерала, а перед ним, например, timestamp `'2016-09-21 22:25:35'`. 

Строго говоря, это не является операцией приведения типа, хотя и похоже на нее. Подробно данный вопрос рассмотрен в разделах документации 4.1.2.
«Константы других типов» и 4.2.9 «Приведения типов».

Для получения значения текущей временной отметки (т. е. даты и времени в одном значении) служит функция `current_timestamp`. 
Она также вызывается без указания круглых скобок. 

```sql
SELECT current_timestamp;
```




Принимает значения от 00:00:00 до 24:00:00. Занимает 8 байт.

* `time with time zone`: хранит время с точностью до 1 микросекунды с указанием часового пояса. 

Принимает значения от 00:00:00+1459 до 24:00:00-1459. Занимает 12 байт.

* `interval`: представляет временной интервал. Занимает 16 байт.

## Распространенные форматы дат:

* `yyyy-mm-dd - 1999-01-08`

* `Month dd, yyyy - January 8, 1999`

* `mm/dd/yyyy - 1/8/1999`

Распространенные форматы времени:

* `hh:mi - 13:21`

* `hh:mi am/pm - 1:21 pm`

* `hh:mi:ss - 1:21:34`